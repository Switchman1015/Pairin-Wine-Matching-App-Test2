<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <title>Pairin - Wine Matching</title>
    <style>
      :root{
        color-scheme: light dark;
        --fg:#fdf8f5;
        --muted:rgba(253,248,245,.86);
        --accent:#ff6d7a;
        --card:rgba(255,255,255,.06);
        --glass:rgba(16,10,22,.28);   /* すりガラス透明度 */
        --radius:28px;
        --shadow:0 24px 80px rgba(0,0,0,.35);
        font-family:"Inter","Noto Sans JP",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      }

      html, body{
        height:100%; overflow:hidden; margin:0;
        -webkit-text-size-adjust:100%;
        touch-action:manipulation;
        background:#000;
      }
      *{ box-sizing:border-box; }
      *::-webkit-scrollbar{ display:none; }
      *{ scrollbar-width:none; -ms-overflow-style:none; }

      /* 背景は写真をそのまま明るく */
      body{
        color:var(--fg);
        background:url("./pairin_title_bg.jpg") center center / cover no-repeat fixed;
        display:flex; align-items:center; justify-content:center;
        padding:clamp(16px,4vw,32px);
      }

      .app{ width:min(980px,100%); }

      /* すりガラス効果を少し弱めたフレーム */
      .frame{
        position:relative;
        border-radius:var(--radius);
        padding:clamp(20px,4vw,36px);
        background:var(--glass);
        backdrop-filter:blur(12px) saturate(120%);
        -webkit-backdrop-filter:blur(12px) saturate(120%);
        box-shadow:var(--shadow);
        overflow:hidden;
      }
      .frame::before{
        content:"";
        position:absolute; inset:0;
        border-radius:inherit;
        padding:2px;
        background:linear-gradient(135deg,#ff7792 0%, #ffa76a 35%, #b777ff 75%, #6ed3ff 100%);
        -webkit-mask:linear-gradient(#000 0 0) content-box,linear-gradient(#000 0 0);
        -webkit-mask-composite:xor;
                mask-composite:exclude;
        pointer-events:none;
      }

      .intro{
        display:grid;
        gap:clamp(16px,3vw,22px);
        text-align:center;
      }

      .logo{
        width:min(240px,56vw);
        aspect-ratio:4/1;
        object-fit:contain;
        justify-self:center;
        filter:drop-shadow(0 6px 18px rgba(0,0,0,.35));
      }

      .title{
        margin:0;
        font-size:clamp(34px,7vw,48px);
        letter-spacing:.06em;
        color:#fff;
        text-shadow:0 2px 10px rgba(0,0,0,.45);
      }
      .caption{
        margin:0;
        color:var(--muted);
        font-size:clamp(14px,2.8vw,18px);
        letter-spacing:.04em;
        text-shadow:0 1px 6px rgba(0,0,0,.35);
      }

      .primary-button{
        justify-self:center;
        padding:14px 36px;
        border:none;
        border-radius:999px;
        background:linear-gradient(120deg, rgba(255,109,122,.95), rgba(255,178,102,.92));
        color:#1a0b20;
        font-size:1rem;
        font-weight:700;
        letter-spacing:.06em;
        cursor:pointer;
        transition:transform .18s ease, box-shadow .18s ease, opacity .18s ease;
        box-shadow:0 10px 26px rgba(0,0,0,.28), 0 12px 28px rgba(255,109,122,.22);
      }
      .primary-button:hover,
      .primary-button:focus-visible{
        transform:translateY(-2px);
        box-shadow:0 16px 30px rgba(255,109,122,.45), 0 12px 26px rgba(0,0,0,.25);
      }

      .app-shell{ display:none; }
      .app-shell[data-active="true"]{ display:grid; gap:16px; }
      header{ display:grid; gap:8px; }
      header h1{ margin:0; font-size:clamp(22px,5vw,28px); letter-spacing:.08em; }
      .header-subtitle{ margin:0; color:var(--muted); font-size:.95rem; }
      main{ display:grid; gap:18px; }

      .progress{ display:flex; gap:12px; align-items:center; padding:6px 0; }
      .progress-bar{ height:6px; border-radius:999px; background:rgba(255,255,255,.12); flex:1; overflow:hidden; }
      .progress-bar span{ display:block; height:100%; width:0%; background:linear-gradient(90deg, var(--accent), #ff8c68); transition:width .2s ease; }

      .question-card, .result-card{
        background:var(--card);
        border-radius:18px;
        padding:clamp(16px,3vw,24px);
        display:grid;
        gap:16px;
      }
      .question-meta{ display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:.9rem; }
      .question-title{ font-size:clamp(18px,4vw,24px); margin:0; }
      .choices{ display:grid; gap:12px; }
      .choice{ display:flex; justify-content:space-between; align-items:center; gap:12px; padding:14px 18px; border-radius:14px; border:1px solid transparent; background:rgba(255,255,255,.06); cursor:pointer; transition:border-color .18s ease, transform .18s ease, background .18s ease; }
      .choice:hover, .choice:focus-visible{ border-color:rgba(244,93,72,.7); transform:translateY(-1px); }
      .choice[data-selected="true"]{ border-color:var(--accent); background:rgba(244,93,72,.18); }
      .choice-label{ display:grid; gap:2px; text-align:left; }
      .choice-label span{ color:var(--muted); font-size:.9rem; }
      .result-card{ display:none; }
      .result-card[data-active="true"]{ display:grid; }
      .result-title{ margin:0; font-size:clamp(22px,5vw,28px); }
      .result-summary{ color:var(--muted); line-height:1.6; white-space:pre-wrap; }

      @media (max-width:600px){
        .choice{ flex-direction:column; align-items:flex-start; }
      }
    </style>
  </head>
  <body>
    <div class="app">
      <div class="frame">
        <section class="intro" data-active="true" id="intro">
          <img class="logo" src="./pairin_logo.png" alt="Pairin ロゴ" />
          <h1 class="title">Pairin</h1>
          <p class="caption">あなたとワインをマッチング</p>
          <button type="button" id="start-button" class="primary-button">はじめる</button>
        </section>

        <div class="app-shell" data-active="false" id="app-shell" aria-hidden="true">
          <header>
            <h1>Pairin</h1>
            <p class="header-subtitle">あなたとワインをマッチング</p>
          </header>
          <main>
            <section class="progress" aria-live="polite">
              <span id="progress-count">0 / 10</span>
              <div class="progress-bar"><span id="progress-fill"></span></div>
            </section>

            <article class="question-card" data-question-index="0" id="question-card">
              <div class="question-meta">
                <span id="question-category">シチュエーション</span>
                <span id="question-step">Q1</span>
              </div>
              <h2 class="question-title" id="question-title">今夜はどんなシーンですか？</h2>
              <div class="choices" role="listbox" aria-labelledby="question-title"></div>
            </article>

            <article class="result-card" id="result-card" aria-live="polite" aria-hidden="true">
              <h2 class="result-title">あなたにおすすめのワイン</h2>
              <p class="result-summary" id="result-summary">回答に応じたおすすめがここに表示されます。</p>
              <button type="button" id="restart-button" class="choice">最初からやり直す</button>
            </article>
          </main>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("gesturestart", e=>e.preventDefault(), {passive:false});
      (function(){let last=0;document.addEventListener("touchend",e=>{const now=Date.now();if(now-last<=350){e.preventDefault();}last=now;},{passive:false});})();

      const questions=[
        {id:"scene",category:"シチュエーション",title:"今夜はどんなシーンですか？",
         options:[{value:"relax",title:"ゆったり自宅で",description:"リラックスタイムに寄り添うワイン"},
                  {value:"celebrate",title:"お祝いディナー",description:"特別感を演出する１本"}]},
        {id:"taste",category:"テイスト",title:"味わいはどちらが好み？",
         options:[{value:"light",title:"軽やか",description:"フレッシュで飲みやすいスタイル"},
                  {value:"rich",title:"濃厚",description:"しっかりとした味わいを堪能"}]},
        {id:"color",category:"カラー",title:"色はどちらに惹かれますか？",
         options:[{value:"white",title:"白ワイン",description:"爽やかな酸味と香り"},
                  {value:"red",title:"赤ワイン",description:"芳醇なコクと余韻"}]},
        {id:"sweetness",category:"甘さ",title:"甘口と辛口、どちら派？",
         options:[{value:"dry",title:"辛口",description:"キリっと引き締まった味わい"},
                  {value:"sweet",title:"甘口",description:"デザートとも相性◎"}]},
        {id:"food",category:"ペアリング",title:"合わせたい料理は？",
         options:[{value:"seafood",title:"魚介",description:"白身魚やシーフードに"},
                  {value:"meat",title:"肉料理",description:"赤身やグリルにぴったり"}]},
        {id:"budget",category:"ご予算",title:"予算のイメージを教えてください",
         options:[{value:"casual",title:"カジュアル (〜3,000円)",description:"気軽に楽しむデイリーワイン"},
                  {value:"premium",title:"プレミアム (5,000円〜)",description:"特別な日の１本"}]},
        {id:"origin",category:"生産国",title:"生産国の好みはありますか？",
         options:[{value:"old-world",title:"旧世界",description:"フランスやイタリアなど"},
                  {value:"new-world",title:"新世界",description:"カリフォルニアやチリなど"}]},
        {id:"sparkling",category:"スパークリング",title:"泡のあるワインは？",
         options:[{value:"still",title:"スティルワイン",description:"落ち着いて味わいたい"},
                  {value:"sparkling",title:"スパークリング",description:"乾杯に華やかさを"}]},
        {id:"body",category:"ボディ",title:"ボディ感はどうですか？",
         options:[{value:"medium",title:"ミディアム",description:"バランスのとれた飲みごたえ"},
                  {value:"full",title:"フルボディ",description:"力強い深みを楽しむ"}]},
        {id:"mood",category:"ムード",title:"今日はどんな気分？",
         options:[{value:"adventure",title:"冒険したい",description:"未知のスタイルに挑戦"},
                  {value:"familiar",title:"定番で安心",description:"いつもの好みでリラックス"}]}
      ];

      const state={index:0,answers:new Map()};
      const intro=document.getElementById("intro");
      const appShell=document.getElementById("app-shell");
      const startButton=document.getElementById("start-button");
      const choicesContainer=document.querySelector(".choices");
      const questionCard=document.getElementById("question-card");
      const resultCard=document.getElementById("result-card");
      const resultSummary=document.getElementById("result-summary");
      const progressFill=document.getElementById("progress-fill");
      const progressCount=document.getElementById("progress-count");
      const questionTitle=document.getElementById("question-title");
      const questionCategory=document.getElementById("question-category");
      const questionStep=document.getElementById("question-step");
      const restartButton=document.getElementById("restart-button");

      startButton.addEventListener("click",startExperience);
      restartButton.addEventListener("click",restart);

      function renderQuestion(index){
        const q=questions[index];
        if(!q){showResult();return;}
        questionCard.dataset.questionIndex=index;
        questionCategory.textContent=q.category;
        questionTitle.textContent=q.title;
        questionStep.textContent=`Q${index+1}`;
        progressCount.textContent=`${index+1} / ${questions.length}`;
        progressFill.style.width=`${(index/questions.length)*100}%`;
        choicesContainer.innerHTML="";
        q.options.forEach(opt=>{
          const btn=document.createElement("button");
          btn.type="button";
          btn.className="choice";
          btn.dataset.value=opt.value;
          btn.innerHTML=`<span class="choice-label"><strong>${opt.title}</strong><span>${opt.description}</span></span><span aria-hidden="true">→</span>`;
          btn.addEventListener("click",()=>handleAnswer(q.id,opt.value));
          choicesContainer.appendChild(btn);
        });
      }
      function handleAnswer(id,value){
        state.answers.set(id,value);
        state.index+=1;
        progressFill.style.width=`${(state.index/questions.length)*100}%`;
        renderQuestion(state.index);
      }
      function startExperience(){
        intro.style.display="none";
        appShell.dataset.active="true";
        appShell.setAttribute("aria-hidden","false");
        state.index=0;state.answers.clear();
        questionCard.style.display="";
        resultCard.dataset.active="false";
        resultCard.setAttribute("aria-hidden","true");
        progressFill.style.width="0%";
        progressCount.textContent=`0 / ${questions.length}`;
        renderQuestion(state.index);
      }
      function showResult(){
        questionCard.style.display="none";
        resultCard.dataset.active="true";
        resultCard.setAttribute("aria-hidden","false");
        progressCount.textContent=`${questions.length} / ${questions.length}`;
        progressFill.style.width="100%";
        resultSummary.textContent=Array.from(state.answers.entries()).map(([k,v])=>`${k}: ${v}`).join("\n")||"回答が選択されていません。";
      }
      function restart(){
        state.index=0;state.answers.clear();
        questionCard.style.display="";
        resultCard.dataset.active="false";
        resultCard.setAttribute("aria-hidden","true");
        progressFill.style.width="0%";
        progressCount.textContent=`0 / ${questions.length}`;
        renderQuestion(state.index);
      }
    </script>
  </body>
</html>
